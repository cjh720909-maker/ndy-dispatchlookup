generator client {
  provider = "prisma-client-js"
  output   = "../../lib/generated/auth"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL")
}

// 사용자/로그인 정보
model User {
  id          Int      @id @default(autoincrement())
  username    String   @unique
  password    String
  role        String   @default("customer") // "staff", "customer", "transport"
  companyName String?  // "하회", "대상" 등, 운수업체명 등
  createdAt   DateTime @default(now())
}

// 당일 기사/용차 등록 정보
model DailyDriverRegistration {
  id               Int      @id @default(autoincrement())
  date             String   // "YYYY-MM-DD"
  driverName       String
  transportCompany String   // 운수업체명 (User.companyName 등과 매핑)
  vehicleNumber    String?  // 차량번호
  phoneNumber      String?  // 연락처
  realDriverName   String?  // 매칭된 기사 실명 추가
  isRegistered     Boolean  @default(true)
  createdAt        DateTime @default(now())

  @@unique([date, driverName, transportCompany])
}

// 운수업체별 전담 기사 풀 (Master List)
model TransportDriver {
  id               Int      @id @default(autoincrement())
  name             String
  phoneNumber      String
  vehicleNumber    String?
  transportCompany String   // User.companyName ("이룸" 등)
  createdAt        DateTime @default(now())

  @@unique([name, phoneNumber, transportCompany])
}

// 용차/기사 정보 서브 정보 (MySQL t_car에 대한 확장 정보)
model VehicleInfo {
  id               Int      @id @default(autoincrement())
  driverName       String   @unique // MySQL의 CB_DRIVER와 매핑
  vehicleType      String   @default("fixed") // "fixed", "outsourced"
  transportCompany String?  // 소속 운수업체명
  phoneNumber      String?  // 연락처 추가
  memo             String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}


// 배수 순서 설정
model DeliverySequence {
  id          Int      @id @default(autoincrement())
  date        String   // "YYYY-MM-DD"
  driverName  String   // MySQL의 CB_DRIVER와 매핑
  cbCode      String   // t_cust_bae의 CB_CODE
  sequence    Int      @default(1)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([date, driverName, cbCode])
}
